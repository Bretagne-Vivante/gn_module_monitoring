=========
CHANGELOG
=========

0.2.1 (unreleased)
------------------

**üöÄ Nouveaut√©s**
  * pouvoir d√©finir des champs *dynamiques*, dont les attributs peuvent d√©pendre des valeurs des autres composants (pour afficher un composant en fonction de la valeur d'autres composants)
    * exemples dans test
  * champs data JSONB dans module_complement

**üêõ Corrections**
  * correction vue synthese

0.2.0 (2020-10-23)
------------------

N√©cessite la version 2.5.2 de GeoNature minimum.

**Nouveaut√©s**

* Possibilit√© de renseigner le JDD √† chaque visite (`#30 <https://github.com/PnX-SI/gn_module_monitoring/issues/30>`__)
* Possibilit√© pour les administrateurs d'associer les JDD √† un sous-module directement depuis l'accueil du sous-module (`#30 <https://github.com/PnX-SI/gn_module_monitoring/issues/30>`__)
* Possibilit√© de cr√©er des groupes de sites (encore un peu jeune) (`#24 <https://github.com/PnX-SI/gn_module_monitoring/issues/24>`__)
* Possibilit√© de cr√©er une visite directement apr√®s la cr√©ation d'un site, et d'une observation directement apr√®s la cr√©ation d'une visite (`#28 <https://github.com/PnX-SI/gn_module_monitoring/issues/28>`__)
* Redirection sur sa page de d√©tail apr√®s la cr√©ation d'un objet, plut√¥t que sur la liste (`#22 <https://github.com/PnX-SI/gn_module_monitoring/issues/22>`__)
* Mise √† jour du composant de gestion et d'affichage des m√©dias
* Ajout d'un composant de liste modulable (``datalist``) pouvant interroger une API, pouvant √™tre utilis√© pour les listes de taxons, d'observateurs, de jdd, de nomenclatures, de sites, de groupes de sites, etc... (`#44 <https://github.com/PnX-SI/gn_module_monitoring/issues/44>`__)
* Liste des observations : ajout d'un param√®tre permettant d'afficher le nom latin des taxons observ√©s (`#36 <https://github.com/PnX-SI/gn_module_monitoring/issues/36>`__)
* Simplification de la proc√©dure pour mettre les donn√©es dans la synth√®se (un fichier √† copier, un bouton √† cocher et possibilit√© de customiser la vue pour un sous-module)
* Passage de la complexit√© des m√©thodes de mise en base des donn√©es et de gestion des relation par liste d'``id`` (observateurs, jdd du module, correlations site module) vers le module `Utils_Flask_SQLA` (am√©lioration de la m√©thode ``from_dict`` en mode r√©cursif qui accepte des listes d'``id`` et les traduit en liste de mod√®les), (principalement dans ``backend/monitoring/serializer.py``)
* Suppression du fichier ``custom.json`` pour g√©rer son contenu dans les nouveaux champs de la table ``gn_monitoring.t_module_complements`` (`#43 <https://github.com/PnX-SI/gn_module_monitoring/issues/43>`__)
* Clarification et remplacement des ``module_path`` et ``module_code`` (`#40 <https://github.com/PnX-SI/gn_module_monitoring/issues/40>`__)

**Corrections**

* Am√©lioration des mod√®les SLQA pour optimiser la partie s√©rialisation (`#46 <https://github.com/PnX-SI/gn_module_monitoring/issues/46>`__)
* Renseignement de la table ``gn_synthese.t_sources`` √† l'installation (`#33 <https://github.com/PnX-SI/gn_module_monitoring/issues/33>`__)
* Passage du commentaire de la visite en correspondance avec le champs ``comment_context`` de la Synth√®se, dans la vue ``gn_monitoring.vs_visits`` (`#31 <https://github.com/PnX-SI/gn_module_monitoring/issues/31>`__)
* Remplissage de la table ``gn_commons.bib_tables_location`` pour les tables du sch√©ma ``gn_monitoring`` si cela n'a pas √©t√© fait par GeoNature (`#27 <https://github.com/PnX-SI/gn_module_monitoring/issues/27>`__)
* Corrections et optimisations diverses du code et de l'ergonomie
* Corrections de la documentation et docstrings (par @jbdesbas)

**‚ö†Ô∏è Notes de version**

Si vous mettez √† jour le module depuis la version 0.1.0 :

* Les fichiers ``custom.json`` ne sont plus utiles (la configuration sp√©cifique √† une installation (liste utilisateurs, etc..) 
est d√©sormais g√©r√©e dans la base de donn√©es, dans la table ``gn_monitoring.t_module_complements``)
* Dans les fichiers ``config.json``, la variable ``data`` (pour pr√©charger les donn√©es (nomenclatures, etc..)) est d√©sormais calcul√©e depuis la configuration. 
* Pour mettre √† jour la base de donn√©es, il faut ex√©cuter le fichier ``data/migration/migration_0.1.0_0.2.0.sql``
* Suivez la proc√©dure classique de mise √† jour du module (``docs/MAJ.rst``)

0.1.0 (2020-06-30)
------------------

Premi√®re version fonctionelle du module Monitoring de GeoNature. N√©cessite la version 2.4.1 de GeoNature minimum.

**Fonctionnalit√©s**

* G√©n√©ration dynamique de sous-modules de gestion de protocoles de suivi
* Saisie et consultation de sites, visites et observations dans chaque sous-module
* G√©n√©ration dynamique des champs sp√©cifiques √† chaque sous-module au niveau des sites, visites et observations (√† partir de configurations json et bas√© sur le composant ``DynamicForm`` de GeoNature)
* Ajout de tables compl√©mentaires pour √©tendre les tables ``t_base_sites`` et ``t_base_visits`` du schema ``gn_monitoring`` permettant de stocker dans un champs de type ``jsonb`` les contenus des champs dynamiques sp√©cifiques √† chaque sous-module
* Ajout de m√©dias locaux ou distants (images, PDF, ...) sur les diff√©rents objets du module, stock√©s dans la table verticale ``gn_commons.t_medias``
* Mise en place de fonctions SQL et de vues permettant d'alimenter la Synth√®se de GeoNature √† partir des donn√©es des sous-modules des protocoles de suivi (#14)
* Ajout d'une commande d'installation d'un sous-module (``flask monitoring install <module_dir_config_path> <module_code>``)
* Ajout d'une commande de suppression d'un sous-module (``remove_monitoring_module_cmd(module_code)``)
* Documentation de l'installation et de la configuration d'un sous-module de protocole de suivi

* Des exemples de sous-modules sont pr√©sents [ici](https://github.com/PnCevennes/protocoles_suivi/)
